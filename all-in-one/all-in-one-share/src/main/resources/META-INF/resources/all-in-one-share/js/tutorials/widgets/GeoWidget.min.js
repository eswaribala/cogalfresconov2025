'use strict';define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/dom-style","alfresco/core/Core"],function(f,e,g,h,k){return f([k],{height:"350px",width:"100%",center:null,zoom:8,markers:null,_leafletLoaded:!1,_leafletLoading:!1,map:null,mapNode:null,constructor:function(a){e.mixin(this,a);this.center=this.center||{lat:13.0827,lon:80.2707};this.markers=this.markers||[]},postCreate:function(){this.inherited(arguments);this.mapNode=g.create("div",{},this.domNode);h.set(this.mapNode,
{height:this.height,width:this.width,border:"1px solid #ccc"});this._ensureLeaflet(e.hitch(this,this._initMap))},_ensureLeaflet:function(a){if(this._leafletLoaded&&window.L)a();else if(this._leafletLoading)var c=this,d=setInterval(function(){c._leafletLoaded&&window.L&&(clearInterval(d),a())},200);else{this._leafletLoading=!0;var b=document.createElement("link");b.rel="stylesheet";b.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css";b.integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=";
b.crossOrigin="";document.head.appendChild(b);b=document.createElement("script");b.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js";b.integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=";b.crossOrigin="";c=this;b.onload=function(){c._leafletLoaded=!0;c._leafletLoading=!1;a()};b.onerror=function(){c._leafletLoading=!1;console.error("Failed to load Leaflet JS")};document.head.appendChild(b)}},_initMap:function(){if(window.L){if(this.map=L.map(this.mapNode).setView([this.center.lat,this.center.lon],
this.zoom),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OSM</a>'}).addTo(this.map),this.markers&&this.markers.length)for(var a=0;a<this.markers.length;a++){var c=this.markers[a],d=L.marker([c.lat,c.lon]).addTo(this.map);c.title&&d.bindPopup("<b>"+c.title+"</b><br/>"+(c.info||""))}}else console.error("Leaflet not available")},onUpdateLocation:function(a){this.map&&a&&this.map.setView([a.lat||this.center.lat,
a.lon||this.center.lon],a.zoom||this.zoom)}})});
